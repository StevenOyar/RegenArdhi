<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Dashboard | RegenArdhi</title>

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />

    <!-- Styles -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/dashboard.css') }}" />
</head>

<body>
    <!-- Navbar -->
    <header>
        <nav class="navbar">
            <div class="logo-container">
                <span class="logo-icon">ðŸŒ¿</span>
                <h1 class="logo"><a href="{{ url_for('main.home') }}">RegenArdhi</a></h1>
            </div>

            <ul class="nav-links" id="navLinks">
                <li><a href="{{ url_for('main.dashboard') }}" class="active">Dashboard</a></li>
                <li><a href="{{ url_for('projects.projects') }}">Projects</a></li>
                <li><a href="/monitoring">Monitoring</a></li>
                <li><a href="/insights">Insights</a></li>
            </ul>

            <div class="nav-actions">
                <!-- Notifications -->
                <div class="notification-menu">
                    <button class="icon-btn" id="notificationBtn">
                        <i class="fas fa-bell"></i>
                        <span class="badge" id="notificationBadge">3</span>
                    </button>
                    <div class="dropdown-menu notification-dropdown" id="notificationDropdown">
                        <div class="dropdown-header">
                            <h4>Notifications</h4>
                            <button class="mark-read-btn" id="markAllRead">Mark all read</button>
                        </div>
                        <div class="notification-list" id="notificationList">
                            <div class="notification-item unread" data-id="1">
                                <i class="fas fa-seedling"></i>
                                <div>
                                    <p>New restoration data available</p>
                                    <span>2 hours ago</span>
                                </div>
                            </div>
                            <div class="notification-item unread" data-id="2">
                                <i class="fas fa-users"></i>
                                <div>
                                    <p>5 new community reports</p>
                                    <span>5 hours ago</span>
                                </div>
                            </div>
                            <div class="notification-item" data-id="3">
                                <i class="fas fa-chart-line"></i>
                                <div>
                                    <p>Weekly progress report ready</p>
                                    <span>1 day ago</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- User Menu -->
                <div class="user-menu">
                    <button class="user-btn" id="userMenuBtn">
                        <i class="fas fa-user-circle"></i>
                        <span id="userDisplayName">{{ user.first_name if user else 'User' }}</span>
                        <i class="fas fa-chevron-down"></i>
                    </button>
                    <div class="dropdown-menu" id="userDropdown">
                        <a href="#profile"><i class="fas fa-user"></i> Profile</a>
                        <a href="#settings"><i class="fas fa-cog"></i> Settings</a>
                        <a href="{{ url_for('main.logout') }}"><i class="fas fa-sign-out-alt"></i> Logout</a>
                    </div>
                </div>

                <!-- Mobile Menu Toggle -->
                <button class="mobile-menu-btn" id="mobileMenuBtn">
                    <i class="fas fa-bars"></i>
                </button>
            </div>
        </nav>
    </header>

    <!-- Flash Messages -->
    {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
    <div class="flash-container">
        {% for category, message in messages %}
        <div class="alert alert-{{ category }}">
            <i class="fas fa-{% if category == 'success' %}check-circle{% elif category == 'error' %}exclamation-circle{% elif category == 'warning' %}exclamation-triangle{% else %}info-circle{% endif %}"></i>
            {{ message }}
            <button class="close-alert"><i class="fas fa-times"></i></button>
        </div>
        {% endfor %}
    </div>
    {% endif %}
    {% endwith %}

    <!-- Dashboard Content -->
    <main class="dashboard">
        <div class="container">
            <!-- Welcome Section -->
            <section class="welcome-section">
                <div class="welcome-content">
                    <h1 id="welcomeTitle">Welcome back, {{ user.first_name if user else 'User' }}! ðŸ‘‹</h1>
                    <p>Monitor your land restoration progress and community impact</p>
                </div>
                <a href="{{ url_for('projects.projects') }}" class="btn btn-primary">
                    <i class="fas fa-plus"></i> New Project
                </a>
            </section>

            <!-- Quick Stats -->
            <section class="stats-section">
                <div class="stats-grid" id="statsGrid">
                    <!-- Loading state - will be replaced by JS -->
                    <div class="stat-card">
                        <div class="skeleton skeleton-icon"></div>
                        <div class="stat-content">
                            <div class="skeleton skeleton-text" style="width: 60%; height: 16px; margin-bottom: 8px;"></div>
                            <div class="skeleton skeleton-text" style="width: 80%; height: 32px;"></div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="skeleton skeleton-icon"></div>
                        <div class="stat-content">
                            <div class="skeleton skeleton-text" style="width: 60%; height: 16px; margin-bottom: 8px;"></div>
                            <div class="skeleton skeleton-text" style="width: 80%; height: 32px;"></div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="skeleton skeleton-icon"></div>
                        <div class="stat-content">
                            <div class="skeleton skeleton-text" style="width: 60%; height: 16px; margin-bottom: 8px;"></div>
                            <div class="skeleton skeleton-text" style="width: 80%; height: 32px;"></div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="skeleton skeleton-icon"></div>
                        <div class="stat-content">
                            <div class="skeleton skeleton-text" style="width: 60%; height: 16px; margin-bottom: 8px;"></div>
                            <div class="skeleton skeleton-text" style="width: 80%; height: 32px;"></div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Main Content Grid -->
            <div class="content-grid">
                <!-- Left Column -->
                <div class="main-column">
                    <!-- Recent Projects -->
                    <section class="card">
                        <div class="card-header">
                            <h2><i class="fas fa-folder-open"></i> Recent Projects</h2>
                            <a href="{{ url_for('projects.projects') }}" class="view-all">View All â†’</a>
                        </div>
                        <div class="projects-list" id="projectsList">
                            <!-- Loading state - will be replaced by JS -->
                            <div class="loading-state">
                                <i class="fas fa-spinner fa-spin"></i>
                                <p>Loading projects...</p>
                            </div>
                        </div>
                    </section>

                    <!-- Activity Feed -->
                    <section class="card">
                        <div class="card-header">
                            <h2><i class="fas fa-stream"></i> Recent Activity</h2>
                        </div>
                        <div class="activity-feed" id="activityFeed">
                            <div class="activity-item">
                                <div class="activity-icon green">
                                    <i class="fas fa-plus"></i>
                                </div>
                                <div class="activity-content">
                                    <p><strong>New monitoring data</strong> added to projects</p>
                                    <span class="activity-time">2 hours ago</span>
                                </div>
                            </div>

                            <div class="activity-item">
                                <div class="activity-icon blue">
                                    <i class="fas fa-satellite"></i>
                                </div>
                                <div class="activity-content">
                                    <p><strong>Satellite analysis</strong> completed for monitored zones</p>
                                    <span class="activity-time">5 hours ago</span>
                                </div>
                            </div>

                            <div class="activity-item">
                                <div class="activity-icon orange">
                                    <i class="fas fa-users"></i>
                                </div>
                                <div class="activity-content">
                                    <p><strong>Community members</strong> submitted field reports</p>
                                    <span class="activity-time">1 day ago</span>
                                </div>
                            </div>

                            <div class="activity-item">
                                <div class="activity-icon purple">
                                    <i class="fas fa-chart-bar"></i>
                                </div>
                                <div class="activity-content">
                                    <p><strong>Monthly report</strong> generated successfully</p>
                                    <span class="activity-time">2 days ago</span>
                                </div>
                            </div>
                        </div>
                    </section>
                </div>

                <!-- Right Column -->
                <div class="sidebar-column">
                    <!-- Quick Actions -->
                    <section class="card">
                        <div class="card-header">
                            <h2><i class="fas fa-bolt"></i> Quick Actions</h2>
                        </div>
                        <div class="quick-actions-grid">
                            <a href="{{ url_for('projects.projects') }}" class="action-btn">
                                <i class="fas fa-map-marker-alt"></i>
                                <span>Add Location</span>
                            </a>
                            <a href="/monitoring" class="action-btn">
                                <i class="fas fa-upload"></i>
                                <span>Upload Data</span>
                            </a>
                            <a href="/insights" class="action-btn">
                                <i class="fas fa-file-alt"></i>
                                <span>View Reports</span>
                            </a>
                            <button class="action-btn" id="shareInsightsBtn">
                                <i class="fas fa-share-alt"></i>
                                <span>Share Insights</span>
                            </button>
                        </div>
                    </section>

                    <!-- Land Health Overview -->
                    <section class="card">
                        <div class="card-header">
                            <h2><i class="fas fa-heartbeat"></i> Land Health</h2>
                        </div>
                        <div class="health-metrics" id="healthMetrics">
                            <div class="metric-item">
                                <div class="metric-label">
                                    <span>Vegetation Cover</span>
                                    <i class="fas fa-info-circle tooltip-icon" title="Percentage of land with healthy vegetation"></i>
                                </div>
                                <div class="metric-bar">
                                    <div class="metric-fill" data-value="78" style="width: 0%; background: linear-gradient(90deg, #10b981, #059669);"></div>
                                </div>
                                <span class="metric-value">78%</span>
                            </div>

                            <div class="metric-item">
                                <div class="metric-label">
                                    <span>Soil Quality</span>
                                    <i class="fas fa-info-circle tooltip-icon" title="Soil health index based on nutrient content"></i>
                                </div>
                                <div class="metric-bar">
                                    <div class="metric-fill" data-value="65" style="width: 0%; background: linear-gradient(90deg, #f59e0b, #d97706);"></div>
                                </div>
                                <span class="metric-value">65%</span>
                            </div>

                            <div class="metric-item">
                                <div class="metric-label">
                                    <span>Water Retention</span>
                                    <i class="fas fa-info-circle tooltip-icon" title="Land's capacity to retain water"></i>
                                </div>
                                <div class="metric-bar">
                                    <div class="metric-fill" data-value="82" style="width: 0%; background: linear-gradient(90deg, #3b82f6, #2563eb);"></div>
                                </div>
                                <span class="metric-value">82%</span>
                            </div>

                            <div class="metric-item">
                                <div class="metric-label">
                                    <span>Biodiversity</span>
                                    <i class="fas fa-info-circle tooltip-icon" title="Species diversity index"></i>
                                </div>
                                <div class="metric-bar">
                                    <div class="metric-fill" data-value="71" style="width: 0%; background: linear-gradient(90deg, #8b5cf6, #7c3aed);"></div>
                                </div>
                                <span class="metric-value">71%</span>
                            </div>
                        </div>
                    </section>

                    <!-- Community Insights -->
                    <section class="card">
                        <div class="card-header">
                            <h2><i class="fas fa-comments"></i> Community</h2>
                        </div>
                        <div class="community-stats">
                            <div class="community-item">
                                <i class="fas fa-map-pin"></i>
                                <div>
                                    <strong id="fieldReportsCount">24</strong>
                                    <span>Field Reports</span>
                                </div>
                            </div>
                            <div class="community-item">
                                <i class="fas fa-camera"></i>
                                <div>
                                    <strong id="photosSharedCount">158</strong>
                                    <span>Photos Shared</span>
                                </div>
                            </div>
                            <div class="community-item">
                                <i class="fas fa-handshake"></i>
                                <div>
                                    <strong id="collaborationsCount">12</strong>
                                    <span>Collaborations</span>
                                </div>
                            </div>
                        </div>
                    </section>
                </div>
            </div>

            <!-- Getting Started Section -->
            <section class="getting-started-section">
                <div class="section-header">
                    <h2><i class="fas fa-rocket"></i> Getting Started</h2>
                </div>
                <div class="cards-grid">
                    <div class="info-card">
                        <i class="fas fa-map"></i>
                        <h3>Map Your Land</h3>
                        <p>Use our tools to identify and map areas that need restoration</p>
                        <a href="{{ url_for('projects.projects') }}" class="btn btn-sm">Get Started</a>
                    </div>
                    <div class="info-card">
                        <i class="fas fa-satellite"></i>
                        <h3>AI Monitoring</h3>
                        <p>Track vegetation changes and soil health with satellite data</p>
                        <a href="/monitoring" class="btn btn-sm">Learn More</a>
                    </div>
                    <div class="info-card">
                        <i class="fas fa-hands-helping"></i>
                        <h3>Join Community</h3>
                        <p>Connect with other restoration practitioners and share insights</p>
                        <button class="btn btn-sm" id="exploreCommunityBtn">Explore</button>
                    </div>
                </div>
            </section>
        </div>
    </main>

    <!-- Footer -->
    <footer>
        <div class="footer-content">
            <p>Â© 2025 RegenArdhi â€¢ Built for a Greener Future ðŸŒ¿</p>
        </div>
    </footer>

    <!-- User Data for JavaScript -->
    <script id="userData" type="application/json">
        {
            "id": {{ user.id if user else 'null' }},
            "firstName": "{{ user.first_name if user else '' }}",
            "lastName": "{{ user.last_name if user else '' }}",
            "email": "{{ user.email if user else '' }}"
        }
    </script>

    <!-- External JavaScript -->
    <script src="{{ url_for('static', filename='js/dashboard.js') }}"></script>
</body>

</html>